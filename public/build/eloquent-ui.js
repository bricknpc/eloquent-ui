(function(){const r="eloquent-ui";class c{constructor(t){var e;if(!t)throw new Error("Currency component element is required");if(this.element=t,this.name=t.dataset[`${this.camelCase(r)}Name`],!this.name)throw new Error("Currency component must have a data-eloquent-ui-name attribute");if(this.wholeInput=t.querySelector(`#${this.name}-whole`),this.centsInput=t.querySelector(`#${this.name}-cents`),this.currencyInput=document.getElementById(`${this.name}-currency`),!this.wholeInput||!this.centsInput)throw new Error(`Currency inputs not found for ${this.name}`);this.config={focusSwitch:t.dataset[`${this.camelCase(r)}FocusSwitch`]!=="false",required:t.dataset[`${this.camelCase(r)}Required`]==="true",min:this.parseNumber(t.dataset[`${this.camelCase(r)}Min`]),max:this.parseNumber(t.dataset[`${this.camelCase(r)}Max`])},this.currencyButton=t.querySelector(`[data-${r}-currency-select]`),this.currencyDropdown=t.querySelector(".dropdown-menu"),this.currencyAnnouncement=((e=t.parentElement)==null?void 0:e.querySelector(`[data-${r}-currency-announcement]`))||document.querySelector(`[data-${r}-currency-announcement][data-${r}-name="${this.name}"]`),this.init()}camelCase(t){return t.replace(/-([a-z])/g,e=>e[1].toUpperCase())}parseNumber(t){if(t==null||t==="")return null;const e=parseInt(t,10);return isNaN(e)?null:e}init(){this.padCents(),this.centsInput.addEventListener("input",this.handleCentsInput.bind(this)),this.centsInput.addEventListener("blur",this.padCents.bind(this)),this.config.focusSwitch&&this.wholeInput.addEventListener("keypress",this.handleDecimalKey.bind(this)),this.wholeInput.addEventListener("paste",this.handlePaste.bind(this)),this.centsInput.addEventListener("paste",this.handlePaste.bind(this)),this.currencyButton&&this.currencyDropdown&&this.initCurrencyDropdown(),this.wholeInput.addEventListener("change",this.validate.bind(this)),this.centsInput.addEventListener("change",this.validate.bind(this))}padCents(){const t=this.centsInput.value;if(t!==""){const e=parseInt(t,10);isNaN(e)||(this.centsInput.value=Math.abs(e).toString().padStart(2,"0"))}}handleCentsInput(t){let e=parseInt(t.target.value)||0;const i=parseInt(this.wholeInput.value)||0;if(e>99){const s=Math.floor(e/100),a=e%100;let n=i+s;this.config.max!==null&&n>this.config.max?(this.wholeInput.value=this.config.max,this.centsInput.value="99"):(this.wholeInput.value=n,this.centsInput.value=a.toString().padStart(2,"0"))}else if(e<0){const s=Math.ceil(Math.abs(e)/100),a=100-Math.abs(e)%100;let n=i-s;this.config.min!==null&&n<this.config.min?(this.wholeInput.value=this.config.min,this.centsInput.value="00"):(this.wholeInput.value=n,this.centsInput.value=(a===100?0:a).toString().padStart(2,"0"))}else this.centsInput.value=e.toString().padStart(2,"0")}handleDecimalKey(t){(t.key===","||t.key===".")&&(t.preventDefault(),this.centsInput.focus(),this.centsInput.select())}parseAmount(t){t=t.trim();const e=t.lastIndexOf("."),i=t.lastIndexOf(",");(e>i?".":",")==="."?t=t.replace(/[,_\s]/g,""):t=t.replace(/[._\s]/g,"").replace(",",".");const a=parseFloat(t);if(isNaN(a))return null;const n=Math.floor(a),o=Math.round((a-n)*100);return{whole:n,cents:o}}handlePaste(t){t.preventDefault();const e=(t.clipboardData||window.clipboardData).getData("text"),i=this.parseAmount(e);if(i!==null){let s=i.whole,a=i.cents;this.config.min!==null&&s<this.config.min&&(s=this.config.min,a=0),this.config.max!==null&&s>this.config.max&&(s=this.config.max,a=99),this.wholeInput.value=s,this.centsInput.value=a.toString().padStart(2,"0"),this.validate()}}initCurrencyDropdown(){const t=this.currencyDropdown.querySelectorAll(".dropdown-item");this.currencyButton.dataset[`${this.camelCase(r)}CurrencySymbol`],t.forEach(e=>{e.addEventListener("click",i=>{i.preventDefault();const s=e.dataset[`${this.camelCase(r)}Value`],a=e.textContent.trim();if(this.currencyButton.textContent=a,this.currencyInput?(this.currencyInput.value=s,this.currencyInput.dispatchEvent(new Event("change",{bubbles:!0}))):console.warn(`Hidden currency input #${this.name}-currency not found`),t.forEach(n=>n.removeAttribute("aria-current")),e.setAttribute("aria-current","true"),this.announceCurrencyChange(s,a),typeof bootstrap<"u"&&bootstrap.Dropdown){const n=bootstrap.Dropdown.getInstance(this.currencyButton);n&&n.hide()}})})}announceCurrencyChange(t,e){if(!this.currencyAnnouncement)return;const s=(this.currencyAnnouncement.dataset[`${this.camelCase(r)}CurrencyAnnouncementMessage`]||"Currency of :attribute has been changed to :key (:value)").replace(":attribute",this.name).replace(":key",t).replace(":value",e);this.currencyAnnouncement.textContent=s,setTimeout(()=>{this.currencyAnnouncement.textContent=""},1e3)}validate(){const t=parseInt(this.wholeInput.value)||0,e=parseInt(this.centsInput.value)||0,i=t*100+e;let s=!0;if(this.config.min!==null){const a=this.config.min*100;i<a&&(s=!1,this.wholeInput.value=this.config.min,this.centsInput.value="00")}if(this.config.max!==null){const a=this.config.max*100;i>a&&(s=!1,this.wholeInput.value=this.config.max,this.centsInput.value="99")}return s}getValue(){return{whole:parseInt(this.wholeInput.value)||0,cents:parseInt(this.centsInput.value)||0,currency:this.currencyInput?this.currencyInput.value:null,amount:parseFloat(`${this.wholeInput.value||0}.${this.centsInput.value||0}`),amountInCents:(parseInt(this.wholeInput.value)||0)*100+(parseInt(this.centsInput.value)||0)}}setValue(t,e,i=null){if(this.wholeInput.value=t,this.centsInput.value=e.toString().padStart(2,"0"),i!==null&&this.currencyInput&&(this.currencyInput.value=i,this.currencyButton)){const s=this.currencyDropdown.querySelector(`[data-${r}-value="${i}"]`);s&&(this.currencyButton.textContent=s.textContent.trim())}this.validate()}destroy(){const t={centsInput:this.handleCentsInput.bind(this),centsBlur:this.padCents.bind(this),wholeKeypress:this.handleDecimalKey.bind(this),wholePaste:this.handlePaste.bind(this),centsPaste:this.handlePaste.bind(this),wholeChange:this.validate.bind(this),centsChange:this.validate.bind(this)};this.centsInput.removeEventListener("input",t.centsInput),this.centsInput.removeEventListener("blur",t.centsBlur),this.wholeInput.removeEventListener("keypress",t.wholeKeypress),this.wholeInput.removeEventListener("paste",t.wholePaste),this.centsInput.removeEventListener("paste",t.centsPaste),this.wholeInput.removeEventListener("change",t.wholeChange),this.centsInput.removeEventListener("change",t.centsChange)}static init(){const t=`[data-${r}-input="currency"]`,e=document.querySelectorAll(t),i=[];return e.forEach(s=>{try{i.push(new c(s))}catch(a){console.error("Failed to initialize currency component:",a,s)}}),i}}window.EloquentUI||(window.EloquentUI={}),window.EloquentUI.Currency=c})();(function(r){var i,s;const c=((i=r.EloquentUIConfig)==null?void 0:i.namespace)||"eloquent-ui",h=`data-${c}-once`,t=`data-${c}-once-others`;class e{constructor(n){if(!(n instanceof HTMLElement))throw new TypeError("Once requires a valid HTMLElement");if(!n.hasAttribute(h)){console.warn("Element does not have once attribute:",n);return}this.element=n,this.others=this._getOtherElements(),this.disabled=!1,this._init()}_init(){this.element.dataset.onceInitialized!=="true"&&(this.element.addEventListener("click",this._handleClick.bind(this)),this.element.dataset.onceInitialized="true")}_getOtherElements(){const n=this.element.getAttribute(t);if(!n)return[];try{const o=document.querySelectorAll(n);return Array.from(o)}catch(o){return console.error("Invalid selector in once-others attribute:",n,o),[]}}_handleClick(n){if(this.disabled)return;const o=this.element.closest("form");o&&!o.checkValidity()||(this._disableButton(this.element),this.others.forEach(l=>{this._disableButton(l)}),this.disabled=!0)}_disableButton(n){n.disabled=!0,n.setAttribute("aria-disabled","true"),n.classList.add("disabled"),n.dataset.originalText||(n.dataset.originalText=n.innerHTML)}enable(){this._enableButton(this.element),this.others.forEach(n=>{this._enableButton(n)}),this.disabled=!1}_enableButton(n){n.disabled=!1,n.setAttribute("aria-disabled","false"),n.classList.remove("disabled"),n.dataset.originalText&&(n.innerHTML=n.dataset.originalText)}destroy(){this.element.removeEventListener("click",this._handleClick),delete this.element.dataset.onceInitialized,this.enable()}static init(n=document){const o=`[${h}]`,l=n.querySelectorAll(o),d=[];return l.forEach(p=>{try{const u=new e(p);d.push(u)}catch(u){console.error("Failed to initialize Once for element:",p,u)}}),d}static autoInit(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{e.init()}):e.init()}}typeof r.EloquentUI>"u"&&(r.EloquentUI={}),r.EloquentUI.Once=e,((s=r.EloquentUIConfig)==null?void 0:s.autoInit)!==!1&&e.autoInit()})(window);
